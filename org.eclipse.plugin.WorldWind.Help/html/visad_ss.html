<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0040)http://www.ssec.wisc.edu/~curtis/ss.html -->
<HTML><HEAD><TITLE>VisAD Visualization SpreadSheet</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.6000.16544" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff fgcolor="000000">
<CENTER><FONT size=+3>VisAD Visualization 
SpreadSheet</FONT></CENTER><BR><BR><FONT size=+3>Contents</FONT><BR>
<UL>
  <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#intro">Introduction</A> 
  <LI><A 
  href="http://www.ssec.wisc.edu/~curtis/ss.html#install">Installation</A> 
  <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#running">Running the 
  SpreadSheet</A> 
  <UL>
    <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#start">Getting 
    started</A> 
    <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#import">Importing 
    data</A> 
    <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#mappings">Setting up 
    mappings from data to display</A> 
    <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#formulas">Using 
    formulas</A> 
    <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#server">Setting up the 
    SpreadSheet as an RMI server</A> 
    <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#client">Remote 
    collaboration with cloned SpreadSheets</A> 
    <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#moreinfo">For more 
    information</A> </LI></UL>
  <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#native">Loading HDF-EOS 
  and HDF-5 files with the SpreadSheet</A> 
  <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#samples">Sample data to 
  try with the SpreadSheet</A> 
  <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#mini">The MiniSheet 
  example</A> 
  <LI><A href="http://www.ssec.wisc.edu/~curtis/ss.html#help">Getting help</A> 
  </LI></UL><BR>
<HR>
<A name=intro></A><FONT size=+2>Introduction</FONT><BR><BR>The VisAD 
Visualization SpreadSheet is a program that utilizes VisAD to visualize data 
sets and do simple computations, without forcing the user to do any Java 
programming. It is a good example of how to build a user interface for a VisAD 
application. <BR><BR>The SpreadSheet is made up of multiple spreadsheet cells, 
much like "traditional" spreadsheet programs, except that each cell is capable 
of displaying a data object (which can be read from a file or computed from 
other cells). To visualize the data object, the SpreadSheet provides an easy and 
flexible way to set up ScalarMaps, as well as a formula entry box, for 
manipulating data from multiple spreadsheet cells. <BR><BR>Of course, the full 
flexibility of VisAD is only accessible to programmers using the class library, 
but the SpreadSheet is an easy way to visualize and compute with many data 
formats, including ASCII, Bio-Rad PIC, BMP, DICOM, DODS, F2000, FITS, GIF, 
HDF-5, HDF-EOS, JPEG, LUT, McIDAS, McIDAS ADDE, netCDF, PGM, PNG, QuickTime, 
ROI, TIFF, Vis5D, and VisAD binary data files. <BR><BR>Here are some 
screen-shots of the SpreadSheet in action (click for a larger picture): 
<BR><BR><A href="http://www.ssec.wisc.edu/~curtis/snap1.jpg"><IMG height=351 
alt="Screen-shot 1" src="visad_ss_files/lilsnap1.jpg" width=412 
border=0></A><BR><BR><BR><A 
href="http://www.ssec.wisc.edu/~curtis/snap2.jpg"><IMG height=424 
alt="Screen-shot 2" src="visad_ss_files/lilsnap2.jpg" width=215 
border=0></A><BR><BR><BR><BR><A name=install></A><FONT 
size=+2>Installation</FONT><BR><BR>To run the SpreadSheet, you must have JDK 
1.2, available from <A href="http://java.sun.com/products/jdk/1.2/">Sun's JDK 
1.2 web site</A>. If you want 3-D displays, you'll also need Java3D 1.2.1, which 
you can obtain from <A href="http://java.sun.com/products/java-media/3D/">Sun's 
Java3D web site</A>. <BR><BR>You must also have VisAD installed. The <A 
href="http://www.ssec.wisc.edu/~billh/visad.html">VisAD home page</A> has 
detailed information about VisAD, including how to download and install VisAD. 
One way to install VisAD is to download <A 
href="ftp://www.ssec.wisc.edu/pub/visad-2.0/visad.jar">visad.jar</A>, then 
include the full path to your visad.jar file in your CLASSPATH environment 
variable. <BR><BR><BR><A name=running></A><FONT size=+2>Running the 
SpreadSheet</FONT> <BR><BR><A name=start></A><FONT size=+1>Getting 
started</FONT><BR><BR>The SpreadSheet is packaged with VisAD. Once you have set 
up your visad.jar file, and modified your CLASSPATH, you can run the SpreadSheet 
by typing: <BR><BR>
<DD>java -mx64m visad.ss.SpreadSheet <BR><BR>The '-mx64m' indicates for Java to 
use up to 64 MB of memory as needed. The SpreadSheet itself can run without this 
command flag, but the larger the data sets that you wish to import, the more 
memory you'll need. <BR><BR><A name=import></A><FONT size=+1>Importing 
data</FONT> <BR><BR>You can import data from a local file, a URL, or an RMI 
address. To import data from a file, choose 'Import data' from the 'File' menu, 
then select the data file that you want to import using the dialog box. 
<BR><BR>To import data from a URL, type the URL into the formula bar (the text 
field next to the ADD and DEL buttons), then press ENTER. <BR><BR>
<HR>
<B>Warning</B>: VisAD does not yet support loading most file formats through 
URLs, making the SpreadSheet unable to import these file types. Only loading of 
GIF, JPEG and PNG files through URLs is supported now. 
<HR>
<BR>To import data from an RMI address, type the RMI address into the formula 
bar with the syntax: <BR><BR>
<DD>rmi://ip.address/ServName/CellData <BR><BR>where ip.address is the IP 
address of the RMI server, ServName is the name of the server, and CellData is 
the name of the remote data object to import (e.g., the first data object of 
spreadsheet cell A1 would be "A1d1"). Local files can be loaded using the 
formula bar as well. <BR><BR>In any case, the SpreadSheet will attempt to 
identify what kind of data it is, then load it into the current cell. If the 
data file is loaded successfully, the SpreadSheet will guess at mappings that 
might work with the data set. If the SpreadSheet cannot determine mappings, or 
you don't like the mappings that it chooses, you will have to assign them 
manually. <BR><BR><A name=mappings></A><FONT size=+1>Setting up mappings from 
data to display</FONT> <BR><BR>To manually edit a cell's mappings, choose 'Edit 
mappings...' from the 'Display' menu. <BR><BR>Here is a screen-shot of the Edit 
Mappings dialog box, and how to use it: <BR><BR><IMG height=684 
alt="Mapping dialog screen-shot and directions" src="visad_ss_files/editmap.jpg" 
width=911> <BR><BR><A name=formulas></A><FONT size=+1>Using formulas</FONT> 
<BR><BR>Sometimes it's nice to be able to compute a data object from other data 
objects using a formula. To do this, first select the cell you'd like to assign 
the formula to by clicking it, then click within the formula text field, type 
your formula in terms of other data objects, and press enter. If the formula 
computes successfully, a new data object will appear within the cell. Otherwise, 
the cell will contain text listing the errors that occurred during the 
evaluation. <BR><BR>For example, say you want to create a data object in cell B2 
that is the average of data objects from cells A1 and B1. You could accomplish 
this by highlighting cell B2, then typing: <BR><BR>
<DD><TT>(A1d1 + B1d1) / 2</TT> <BR><BR>in the formula text field, and pressing 
enter. If the first data object from cell A1 ("A1d1") and the first data object 
from cell B1 ("B1d1") have compatible data structures (MathTypes), then cell B2 
will contain a data object (e.g., "B2d1") that represents their average. 
<BR><BR><A name=server></A><FONT size=+1>Setting up the SpreadSheet as an RMI 
server</FONT> <BR><BR>If you run the SpreadSheet as an RMI server, then 
SpreadSheets on other machines will be able to access your SpreadSheet's data 
objects as RMI addresses. To run the SpreadSheet as an RMI server, launch the 
SpreadSheet with the "-server" flag like: <BR><BR>
<DD>java -mx64m visad.ss.SpreadSheet -server MyServer <BR><BR>where MyServer is 
what you wish to name the server. Now other SpreadSheets can import your 
SpreadSheet's data objects as explained in the <A 
href="http://www.ssec.wisc.edu/~curtis/ss.html#import">Importing data</A> 
section. <BR><BR><A name=client></A><FONT size=+1>Remote collaboration with 
cloned SpreadSheets</FONT> <BR><BR>A SpreadSheet can be constructed as a clone 
of a SpreadSheet RMI server running on another machine. The cloned sheet will be 
linked with the server, and changes to one will be reflected on the other. To 
create a cloned SpreadSheet, launch the SpreadSheet with the "-client" flag 
like: <BR><BR>
<DD>java -mx64m visad.ss.SpreadSheet -client ip.address/ServName <BR><BR>where 
ip.address is the IP address of the SpreadSheet RMI server and ServName is the 
name of the server. <BR><BR><A name=moreinfo></A><FONT size=+1>For more 
information</FONT> <BR><BR>See the <A 
href="http://www.ssec.wisc.edu/~curtis/README.ss">README.ss</A> file for more 
detailed information about the SpreadSheet's features and how to use them. 
<BR><BR><BR><A name=native></A><FONT size=+2>Loading HDF-EOS and HDF-5 files 
with the SpreadSheet</FONT> <BR><BR>Logic to load HDF-EOS and HDF-5 files is 
currently implemented in VisAD. However, the loaders must utilize native C code, 
which is set up to compile on Sun Solaris or Irix machines only. Native HDF-5 
code is available for several other platforms; see the <A 
href="http://hdf.ncsa.uiuc.edu/java-hdf5-html/JHI5/">JHI5 web site</A> for more 
information. <BR><BR>To compile the native code, you will need to take the 
following steps: <BR><BR>1) Download the <A 
href="ftp://www.ssec.wisc.edu/pub/visad-2.0/visad_src-2.0.jar">source code 
version of VisAD</A> from the VisAD FTP site. <BR><BR>2) Extract the jar file by 
typing: 
<DD>jar xvf visad_src-2.0.jar <BR><BR>3) Change your CLASSPATH environment 
variable to include the parent directory of the visad directory (instead of the 
visad.jar file). For example, if you have installed VisAD to /java/visad, then 
type: 
<DD>setenv CLASSPATH /java;. <BR><BR>4) Follow the directions in the 
visad/data/hdfeos/README.hdfeos and visad/README files to install HDF-EOS and 
HDF-5. <BR><BR>5) Set the required HDF-related variables (HDF_INC, HDF_LIB, 
HDFEOS_INC and HDFEOS_LIB), to their respective include and library directories 
of your HDF installations, if they are not set already. <BR><BR>6) Compile VisAD 
by typing: 
<DD>cd visad 
<DD>make compile <BR><BR>The VisAD source files and all native code will be 
compiled. Be patient; the compile can take a few minutes to run depending on 
your machine. After the compile finishes successfully, you should be able to 
load HDF-EOS and HDF-5 files using the VisAD SpreadSheet. <BR><BR>If you are 
using Windows, you can enable HDF-5 support by installing the <A 
href="http://hdf.ncsa.uiuc.edu/HDF5/">HDF-5 library</A> and <A 
href="http://hdf.ncsa.uiuc.edu/java-hdf5-html/JHI5/">Java HDF5 Interface</A> 
according to NCSA's <A 
href="http://hdf.ncsa.uiuc.edu/java-hdf5-html/JHI5/install.html">installation 
instructions</A>. <BR><BR><BR><A name=samples></A><FONT size=+2>Sample data to 
try with the SpreadSheet</FONT><BR><BR>Here is some interesting sample data to 
try out with the SpreadSheet. All of these files are in the public domain. 
<LI><A href="http://www.ssec.wisc.edu/~curtis/samples/b2rlc.nc">b2rlc.nc</A> 
(130 KB) -- An interesting netCDF file with five time steps. Try mapping 
<TT>wnum1</TT> to <TT>X Axis</TT>, <TT>atmosphericRadiance</TT> to <TT>Y 
Axis</TT>, and <TT>time</TT> to <TT>Z Axis</TT>, <TT>Animation</TT>, or 
<TT>Select Value</TT>. 
<LI><A href="http://www.ssec.wisc.edu/~curtis/samples/small.v5d">small.v5d</A> 
(518 KB) -- This small Vis5D file has three variables. Try mapping <TT>time</TT> 
to <TT>Animation</TT>, <TT>row</TT> to <TT>X Axis</TT>, <TT>col</TT> to <TT>Y 
Axis</TT>, <TT>lev</TT> to <TT>Z Axis</TT>, and <TT>U</TT>, <TT>V</TT>, and 
<TT>W</TT> to <TT>Iso-contour</TT>. Then, use the contour controls to change the 
values of <TT>U</TT>, <TT>V</TT>, and <TT>W</TT>. 
<LI><A href="http://www.ssec.wisc.edu/~curtis/samples/rad.nc">rad.nc</A> (133 
KB) -- This netCDF file's default mappings are interesting, but also be sure to 
try mapping <TT>mdr_x</TT> to <TT>X Axis</TT>, <TT>mdr_y</TT> to <TT>Y 
Axis</TT>, <TT>longitude</TT> to <TT>Red</TT>, <TT>latitude</TT> to 
<TT>Green</TT>, and <TT>mdr</TT> to <TT>Blue</TT>. 
<LI><A href="http://www.ssec.wisc.edu/~curtis/samples/rosat.fits">rosat.fits</A> 
(523 KB) -- Using the default mappings, change the hi value of the range of 
<TT>value</TT> mapped to <TT>RGB</TT> to around 120, and the image will be much 
clearer. 
<LI><A href="http://www.ssec.wisc.edu/~curtis/samples/sphere.jpg">sphere.jpg</A> 
(5 KB) -- The default mappings will display this JPEG file fine, but you can 
spice up the visualization by mapping <TT>ImageLine</TT> and 
<TT>ImageElement</TT> to <TT>Latitude</TT> and <TT>Longitude</TT> instead of 
<TT>X Axis</TT> and <TT>Y Axis</TT>, and perhaps even mapping <TT>Red</TT>, 
<TT>Green</TT>, or <TT>Blue</TT> to <TT>Radius</TT>. <BR><BR><BR><A 
name=mini><FONT size=+2>The MiniSheet example</FONT><BR><BR>The MiniSheet 
program, found in the visad/examples directory of your VisAD source file 
installation, provides a simple example of how to use the visad.ss classes in an 
application. Of course, visad.ss.SpreadSheet itself provides a detailed and rich 
example, but MiniSheet is much more approachable because of its simplicity (it 
is less than 300 lines of code, much of which sets up the GUI). <BR><BR>Here is 
a screenshot of the MiniSheet program (click for a larger picture): <BR><BR><A 
href="http://www.ssec.wisc.edu/~curtis/mini.jpg"><IMG height=225 
alt="Screen-shot thumbnail" src="visad_ss_files/lilmini.jpg" width=507 
border=0></A><BR><BR><BR><BR><A name=help><FONT size=+2>Getting 
help</FONT><BR><BR>If you need help using the SpreadSheet or have a question 
about it, first check the <A 
href="http://www.ssec.wisc.edu/~curtis/README.ss">README.ss</A> file. If you 
can't find an answer there, feel free to send e-mail to the <A 
href="mailto:visad-list@ssec.wisc.edu">VisAD mailing list</A>. <BR><BR>To 
subscribe to the VisAD mailing list, send e-mail to <A 
href="mailto:majordomo@ssec.wisc.edu">majordomo@ssec.wisc.edu</A> with no 
subject and <BR><BR></LI>
<DD>subscribe visad-list <BR><BR>as the first line in the message body. 
<BR><BR>To report a bug in the SpreadSheet, please send e-mail to the <A 
href="mailto:visad-list@ssec.wisc.edu">VisAD mailing list</A> with a description 
of the problem, and if possible, a list of steps to reproduce it. Keep in mind 
that the SpreadSheet runs using VisAD functionality, which in turn takes 
advantage of JDK 1.2, which runs on top of your operating system, so any bug you 
find could be anywhere within this hierarchy. Note especially that if the 
SpreadSheet fails to load a data file, chances are that the SpreadSheet is not 
at fault, but rather the corresponding VisAD data form is not yet advanced 
enough to handle that specific data file. <BR><BR>
<HR>
<FONT size=-1>This page was last updated Wednesday, 27 March, 2002.</FONT> 
</DD></BODY></HTML>
